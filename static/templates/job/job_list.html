
<div class="container-wrap">
    <div class="menu-wrap">
        <nav id="sidemenu" class="menu">
            <div class="icon-list">
                <h3>Filter</h3>
                <a type="button" class="menu-item" data-toggle="collapse" data-target="#industry">Industry Type</a>
                <div id="industry" class="collapse dropdown-fix">
                    <div ng-repeat="ind in industry_info">
                        <label>
                            <input type="checkbox" class="faChkRnd" ng-click="FilterIndustry(ind.id)"/><span class="checkbox-label">{{ ind.type_industry }}</span></br/>
                        </label>
                    </div>
                </div>
                <a type="button" class="menu-item" data-toggle="collapse" data-target="#location">Job Location</a>
                <div id="location" class="collapse dropdown-fix">
                    <div ng-repeat="loc in location_info">
                        <label>
                            <input type="checkbox" class="faChkRnd" ng-click="FilterLocation(loc.id)"/><span class="checkbox-label">{{ loc.location }}</span></br/>
                        </label>
                    </div>
                </div>
                <a type="button" class="menu-item" data-toggle="collapse" data-target="#Salary">Salary Range</a>
                <div id="Salary" class="collapse dropdown-fix">
                    <div ng-repeat="sal in salary_info">
                        <label>
                            <input type="checkbox" class="faChkRnd" ng-click="FilterSalary(sal.id)"/><span class="checkbox-label">{{ sal.sal_range }}</span></br/>
                        </label>
                    </div>
                </div>
                <a type="button" class="menu-item" data-toggle="collapse" data-target="#Experience">Experience Level</a>
                <div id="Experience" class="collapse dropdown-fix">
                    <div ng-repeat="exp in experience_info">
                        <label>
                            <input type="checkbox" class="faChkRnd" ng-click="FilterExperience(exp.id)"/><span class="checkbox-label">{{ exp.experience_level }}</span></br/>
                        </label>
                    </div>
                </div>
            </div>
        </nav>
    </div>
    <span id="open-button" class="menu-white"><span class="label" style="color: rgb(0,0,0);">FILTER</span> </span>
    <a id="user-nav" class="userNav" onclick="openNav()"><i class="fa fa-user"></i></a>
    <div id="userContent" class="userContainer" ng-controller='LogoutCtrl'>
        <a id="btn-2" ng-click="logoutNow()" class="userNavBtn">Logout</a>
    </div>

    <div class="content-wrap">
        <div class="content">
            <nav class="dashHeader text-center navbar navbar-default fixed top"><span>ICRUITS</span></nav>
            <section id="dashboard" style="margin-top: 75px;">
                <div class="containerSub cf">
                    <div class="row">
                        <div class="col-sm-3" 
                             data-ng-repeat="JobFeed in blueprints | filter:industryFilter | filter:locationFilter | filter:salaryFilter | filter:experienceFilter">
                            <div class="job-item text-center">
                                <div class="hover-bg hover-bg-articles">
                                    <a data-ui-sref="root.blueprint({name_slug: JobFeed.name_slug})">
                                        <!--img class="img-responsive"
                                                data-ng-src="{{ JobFeed.image }}" alt=""-->
                                        <div class="hover-text">
                                            <span class="lead" data-ng-bind="JobFeed.max_queue"></span>
                                        </div>
                                        <img class="img-circle img-thumbnail" src="">
                                        <span class="nohover center-block" data-ng-bind="JobFeed.name"></span>
                                        <span class="nohover center-block" data-ng-bind="user.related_profile_type"></span>
                                        <span class="hover company center-block" data-ng-bind="JobFeed.company_name"></span>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <a id="filter-btn" onclick="openBigNav()" ng-show="!user.profile_type">
                    <span>
                        Blueprint
                    </span>
                    <span class="hover">
                        Blueprint
                    </span>
                </a>
            </section>
        </div>
    </div>
</div>

<!-- FULLSCREEN NAV -->
<div id="myNav" class="overlay-offcanvas">
    <a id="back-btn" class="hide-button" onclick="closeBigNav()">
        <span id="advanced-span" class="show-button">
            x
        </span>
        <span id="advanced-span-2" class="hover show-button">
            x
        </span>            
    </a>
    <a id="apply-btn" class="hide-button" ng-click="createBlueprint()">
        <span id="apply-span" class="hide-button">
            Finish
        </span>
        <span id="apply-span-2" class="hover hide-button">
            Finish
        </span>
    </a>
    <!--a id="advanced-btn" class="hide-button">
        <span id="advanced-span" class="hide-button">
            Advanced
        </span>
        <span id="advanced-span-2" class="hover hide-button">
            Advanced
        </span>
    </a-->
    <div class="blueprintContainer">
        <div class="row">
            <span class="new blueprintLabel"> Blueprint Name </span>
            <input type="text" 
                   class="form-control blueprintInput blueprintName" 
                   name="name"
                   ng-model="make_blueprint.name"
                   required>
        </div>
        <hr class="hrTopTen">
        <div class="row">
            <span class="new blueprintLabel"> Company Name </span>
            <input type="text" 
                   name="company name"
                   class="form-control blueprintInput blueprintCompany"
                   ng-model="make_blueprint.company_name"
                   required>
        </div>
        <div class="row">
            <span class="new blueprintLabel"> Team ID </span>
            <input type="text" 
                   name="team id"
                   class="form-control blueprintTeamID"
                   ng-model="make_blueprint.team_id" 
                   required>
        </div>
        <hr class="hrTopTen">
        <div class="row">
            <span class="new blueprintLabel"> Industry </span>
            <select class="form-control blueprintInput" 
                    name="job_industry"
                    ng-model="make_blueprint.related_industry"
                    ng-options="option.id*1 as option.type_industry for option in industry_info">
                <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel"> Employer Size </span>
            <select class="form-control blueprintInput" 
                    name="employer_size"
                    ng-model="make_blueprint.related_company_type"
                    ng-options="option.id*1 as option.types_of_company for option in company_type_info">
                <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel marginBlueprint"> Job Function </span>
            <input type="text" 
                   name="job function"
                   class="form-control inputSizeFix"
                   ng-model="make_blueprint.function" 
                   required>
            <span class="new blueprintLabel"> Experience </span>
            <select class="form-control blueprintInput" 
                    name="experience info"
                    ng-model="make_blueprint.related_experience"
                    ng-options="option.id*1 as option.experience_level for option in experience_info">
                <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel"> Location </span>
            <select class="form-control blueprintInput" 
                    name="location info"
                    ng-model="make_blueprint.related_location"
                    ng-options="option.id*1 as option.location for option in location_info">
                    <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel"> Job Type </span>
            <select class="form-control blueprintInput" 
                    name="job type"
                    ng-model="make_blueprint.related_job_type"
                    ng-options="option.id*1 as option.employment for option in job_type_info">
                <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel"> Wait Interval </span>
            <select class="form-control blueprintInput" 
                    name="wait interval"
                    ng-model="make_blueprint.related_wait_interval"
                    ng-options="option.id*1 as option.response_time for option in wait_interval_info">
                <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel marginBlueprint"> On Success </span>
            <select class="form-control blueprintInput" 
                    name="On success"
                    ng-model="make_blueprint.related_on_success"
                    ng-options="option.id*1 as option.success for option in on_job_success_info">
            <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel marginBlueprint"> Job Duration </span>
            <select class="form-control blueprintInput" 
                    name="job duration"
                    ng-model="make_blueprint.related_job_duration"
                    ng-options="option.id*1 as option.job_duration for option in job_duration_info">
                <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel"> Salary Range </span>
            <select class="form-control blueprintInput" 
                    name="salary range"
                    ng-model="make_blueprint.related_salary"
                    ng-options="option.id*1 as option.sal_range for option in salary_info">
                <option value="" ng-show="false"></option>
            </select>
        </div>
        <hr>
        <div class="row">
            <span class="new blueprintLabel"> Qualification </span>
            <input type="text" 
                   class="form-control blueprintInput inputSizeFix"
                   name="professional qualifications"
                   ng-model="make_blueprint.professional_qualifications"
                   required>
            <span class="new blueprintLabel"> Practice Limit </span>
            <input type="number" 
                   name="practice limit"
                   class="form-control inputSizeFix"
                   ng-model="make_blueprint.practice_limit" 
                   required>
            <span class="new blueprintLabel"> Remote Work </span>
            <input type="text" 
                   name="remote work"
                   class="form-control inputSizeFix"
                   ng-model="make_blueprint.remote_work" 
                   required>
            <span class="new blueprintLabel"> Visa Status </span>
            <select class="form-control blueprintInput" 
                    name="visa status"
                    ng-model="make_blueprint.related_visa_status"
                    ng-options="option.id*1 as option.visa for option in visa_status_info">
                <option value="" ng-show="false"></option>
            </select>
            <span class="new blueprintLabel"> Max Queue </span>
            <input type="number" 
                   name="max queue"
                   class="form-control inputSizeFix"
                   ng-model="make_blueprint.max_queue" 
                   required>
            <span class="new blueprintLabel"> Download Url </span>
            <input type="text" 
                   name="download url"
                   class="form-control inputSizeFix"
                   ng-model="make_blueprint.url" 
                   required>
        </div>
    </div>
    <div class="blueprintTasksContainer">
        <hr class="hrTopTen">

        <div class="row">
            <div class="expert-select">
                <span class="new blueprint-tast-label"> Blueprint Tasks </span>
                 <select class="form-control blueprintTasksInput"
                        id="selectTask" 
                        name="blueprint tasks"
                        ng-model="make_blueprint.related_tasks"
                        ng-options="option.id*1 as option.name for option in blueprint_tasks">
                    <option value="" ng-show="false"></option>
                </select>
            </div>
            <div class="expert-select">
                <span class="new blueprint-tast-label"> Expert Ref </span>
                <select class="form-control blueprintRefFix"
                        id="expId"
                        ng-model="make_blueprint.related_ref"
                        ng-options="option.id*1 as option.username for option in user_list">
                    <option value="" ng-show="false"></option>
                </select>
            </div>
        </div>
        <span class="btn btn-info" 
              style="font-size:20px;margin-left:3%;" 
              id="addNewRow">
            <b class="fa fa-plus-circle"></b>
        </span>
        <table class="table" id="hiddenTable">
            <tbody>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
        </table>

    </div>

    <div class="blueprintContainer" style="margin-top: 0;">
        <div class="row">
            <span class="new blueprintLabel"> Description </span>
            <textarea name="description" 
                   ng-model="make_blueprint.description"
                   class="blueprintDesc" rows="4" cols="50"></textarea>
        </div>
        <center>
            <div class="row">
                <span class="new blueprintLabel"> Work Environment </span>
                <a class="btn" ngf-select="upload($file)">Browse</a>
                <div class="previewImage">
                    <img ngf-thumbnail="preview || '/static/img/logo.png'">
                </div>
            </div>
        </center>
        <hr class="hrBotTen">
        <hr class="hrBotTen">
    </div>
</div>        

        <!--hr>
        <div class="row">
            <span class="new blueprintLabel"> Publish Blueprint </span>
            <label class="blueprintRadioLabel">
                <input class="register-radio" 
                       type="radio"
                       name="publish radio"
                       ng-value="true"
                       ng-model="make_blueprint.is_published"/>
                Yes
            </label>
        </div>
        <div class="row">
            <label class="blueprintRadioLabel" style="margin-left: 174px;">
                <input class="register-radio" 
                       type="radio"
                       name="publish radio"
                       ng-value="false"
                       ng-model="make_blueprint.is_published"
                       checked/>
                No
            </label>
        </div-->


<!-- SMALL CANVAS MENU -->
<aside id="sidenav" class="sidenav" ng-controller='LogoutCtrl'>
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <span class="label-close" style="color: rgb(255,255,255); margin-top: -6px; margin-right: 12px;">CLOSE</span>
    <div class="">
        <h3>USER</h3>
    </div>
    <!--a data-ui-sref="root.dashboard">Dashboard</a-->
    <a class="menu-item">Profile</a>
    <a href='' class="menu-item" ng-click="logoutNow()">Logout</a>
</aside>

<script type="text/javascript">
(function() {

    var bodyEl = document.body,
        content = document.querySelector( '.content-wrap' ),
        openbtn = document.getElementById( 'open-button' ),
        closebtn = document.getElementById( 'close-button' ),
        isOpen = false;

    var filterBtn = document.getElementById('filter-btn');


    function init() {
        initEvents();
    }

    function initEvents() {
        openbtn.addEventListener( 'click', toggleMenu );
        if( closebtn ) {
            closebtn.addEventListener( 'click', toggleMenu );
        }

        // close the menu element if the target it´s not the menu element or one of its descendants..
        content.addEventListener( 'click', function(ev) {
            var target = ev.target;
            if( isOpen && target !== openbtn ) {
                toggleMenu();
            }
        } );
    }

    function toggleMenu() {
        if( isOpen ) {
            classie.remove( bodyEl, 'show-menu' );
            /*classie.remove(filterBtn, 'hide-button');*/
            // animate path
        }
        else {
            classie.add( bodyEl, 'show-menu' );
            /*classie.add(filterBtn, 'hide-button');*/
            // animate path
        }
        isOpen = !isOpen;
    }

    function fixMenu() {
        classie.remove(bodyEl, 'show-menu');
        /*classie.remove(filterBtn, 'hide-button');*/
    }

    init();
    var fixer = true;
    if(fixer) {
        $(window.location).trigger("change", fixMenu());
        fixer = false;
    }

})();    
</script>
<script>
$("#addNewRow").click(function(){
    var taskId = $('#selectTask').val().replace('number:', '');
    var taskName = $('#selectTask option:selected').text();
    var expertEmail = $('#expId').text();
    $('#selectTask').find('option[value='+taskId+']').attr('disabled','disabled');
    //$('#hiddenTable tr:last').after("<tr><td><span class='btn btn-small btn-danger rembtn'><i class='fa fa-minus'></i></span></td><td><input type='text' value='"+taskName+"' class='form-control' readonly /><input type='hidden' name='task[]' value='"+taskId+"' class='form-control' readonly /></td><td><input type='email' name='expert_ref[]' value='"+expertEmail+"' class='form-control' readonly /></td></tr>");
    $('#hiddenTable tr:last').after("<tr><td><span class='btn btn-small btn-danger rembtn'><i class='fa fa-minus'></i></span></td><td><input type='text' value='"+taskName+"' class='form-control' readonly /><input type='hidden' name='task[]' value='"+taskName+"' class='form-control' readonly /></td><td><input type='email' name='expert_ref[]' value='"+expertEmail+"' class='form-control' readonly /></td></tr>");

    // method to push objects into make_blueprint_tasks
    // call angular addTask
    function addSelectedTask() {
        // body...
        var userId = $('#expId').val().replace('number:', '');
        var task = {name: $('#selectTask option:selected').text(), expert: parseInt(userId), task_status: "Active"};
        angular.element(document.getElementById('selectTask')).scope().addTask(task);
    }
    addSelectedTask();
});
$("#hiddenTable").on('click','.rembtn',function(){
    var taskId = $(this).parent().parent('tr').find('td:eq(1)').find('input[type=hidden]').val();
    //$('#selectTask').find('option[value='+taskId+']').attr('disabled',false);//*[@id="hiddenTable"]/tbody/tr[2]/td[2]/input[1]

    function removeSelectedTask(taskId) {
        // body...
        angular.element(document.getElementById('selectTask')).scope().removeTask(taskId);
    }

    removeSelectedTask(taskId);
    $(this).parent().parent('tr').remove();
});
    
$(document).ready(function() {
    $('#rootwizard').bootstrapWizard({onTabShow: function(tab, navigation, index) {
        var $total = navigation.find('li').length;
        var $current = index+1;
        var $percent = ($current/$total) * 100;
        $('#rootwizard .progress-bar').css({width:$percent+'%'});
    }});    
});
</script>
